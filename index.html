<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#f5f3ed">
    <title>Pre-Invitación de Boda</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Playfair+Display:wght@400;600;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- Scripts de Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="supabase-service.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            overflow-x: hidden;
            overflow-y: hidden;
            width: 100%;
            width: 100vw;
            max-width: 100vw;
            height: 100%;
            height: 100vh;
            height: 100dvh;
            height: -webkit-fill-available;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: #f5f3ed;
            background-image: 
                radial-gradient(circle at 1px 1px, rgba(0,0,0,0.02) 1px, transparent 0);
            background-size: 20px 20px;
            min-height: 100vh;
            min-height: 100dvh;
            min-height: -webkit-fill-available;
            overflow-x: hidden;
            overflow-y: hidden;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            width: 100vw;
            max-width: 100vw;
            height: 100vh;
            height: 100dvh;
            height: -webkit-fill-available;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
        }

        body.main-content-visible {
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* ========== PANTALLA DE PRESENTACIÓN ========== */
        .welcome-screen {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            height: 100dvh !important;
            height: -webkit-fill-available !important;
            min-height: 100vh !important;
            min-height: 100dvh !important;
            min-height: -webkit-fill-available !important;
            background: #faf8f3;
            background-image: 
                radial-gradient(circle at 1px 1px, rgba(0,0,0,0.02) 1px, transparent 0);
            background-size: 20px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 30px 20px !important;
            margin: 0 !important;
            border: none !important;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
            overflow: hidden;
            box-sizing: border-box;
        }

        .welcome-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* Imagen decorativa de fondo - elegante y visible */
        .welcome-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-image: url('decoracion.png');
            background-size: 70%;
            background-position: center center;
            background-repeat: no-repeat;
            z-index: 0;
            pointer-events: none;
            opacity: 0.5;
            mix-blend-mode: multiply;
        }

        .welcome-screen::after {
            display: none !important;
        }

        /* Contenedor welcome-content eliminado - contenido directamente en welcome-screen */

        /* Monograma PNG - diseño elegante */
        .monogram-container {
            position: relative;
            margin: 0 auto 20px;
            width: 100%;
            max-width: 100%;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            flex-shrink: 0;
            text-align: center;
            z-index: 2;
            padding: 10px;
        }

        .monogram-svg {
            width: auto;
            height: auto;
            max-width: 350px;
            max-height: 350px;
            width: 350px;
            height: auto;
            object-fit: contain;
            background: transparent;
            mix-blend-mode: darken;
            filter: 
                contrast(1.2) 
                brightness(0.98)
                drop-shadow(0 4px 12px rgba(0, 0, 0, 0.12));
            -webkit-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            z-index: 2;
            position: relative;
            transition: transform 0.3s ease;
        }

        .monogram-svg:hover {
            transform: scale(1.02);
        }

        .monogram-svg[src*="logo"] {
            background: transparent !important;
            mix-blend-mode: darken;
            filter: 
                contrast(1.4) 
                brightness(0.9)
                drop-shadow(0 2px 8px rgba(0, 0, 0, 0.08));
        }

        .welcome-subtitle {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            color: #3a3a3a;
            margin-bottom: 12px;
            font-weight: 400;
            letter-spacing: 3px;
            text-transform: uppercase;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
            flex-shrink: 0;
            text-align: center;
            z-index: 2;
            position: relative;
            opacity: 0.85;
        }

        .names-welcome {
            font-family: 'Dancing Script', cursive;
            font-size: 36px;
            color: #2c2c2c;
            font-weight: 600;
            line-height: 1.4;
            margin: 0 0 15px;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
            flex-shrink: 0;
            text-align: center;
            z-index: 2;
            position: relative;
            letter-spacing: 1px;
        }

        .ampersand {
            font-family: 'Dancing Script', cursive;
            font-size: 32px;
            color: #8b7355;
            margin: 0 12px;
            font-weight: 500;
            opacity: 0.8;
        }

        .welcome-special-message {
            font-family: 'Playfair Display', serif;
            font-size: 16px;
            color: #5a5a5a;
            margin: 12px 0;
            font-weight: 400;
            font-style: italic;
            width: 100%;
            padding: 0 30px;
            box-sizing: border-box;
            flex-shrink: 0;
            text-align: center;
            z-index: 2;
            position: relative;
            line-height: 1.6;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .welcome-separator {
            width: 180px;
            height: 1px;
            background: linear-gradient(to right, transparent, #8b7355, transparent);
            margin: 15px auto;
            flex-shrink: 0;
            z-index: 2;
            position: relative;
            opacity: 0.6;
        }

        .welcome-separator::before,
        .welcome-separator::after {
            content: '❋';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: #8b7355;
            font-size: 12px;
            opacity: 0.5;
        }

        .welcome-separator::before {
            left: -25px;
        }

        .welcome-separator::after {
            right: -25px;
        }

        .welcome-date-time {
            margin: 12px 0;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
            flex-shrink: 0;
            text-align: center;
            z-index: 2;
            position: relative;
        }

        .welcome-date {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            color: #3a3a3a;
            margin-bottom: 0;
            font-weight: 400;
            letter-spacing: 2px;
        }

        .welcome-btn {
            background: transparent;
            color: #2c2c2c;
            padding: 14px 40px;
            border: 2px solid #2c2c2c;
            border-radius: 0;
            font-size: 13px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.4s ease;
            font-family: 'Playfair Display', serif;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin: 20px auto 0;
            position: relative;
            z-index: 10;
            display: block;
            visibility: visible;
            opacity: 1;
            width: auto;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .welcome-btn:hover {
            background: #2c2c2c;
            color: #faf8f3;
            border-color: #2c2c2c;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(44, 44, 44, 0.3);
        }

        .welcome-btn:active {
            transform: translateY(0);
        }

        /* ========== CONTENIDO PRINCIPAL (INVITACIÓN) ========== */
        .main-content {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 20px;
            padding-top: max(calc(20px + env(safe-area-inset-top)), 20px);
            padding-bottom: max(calc(20px + env(safe-area-inset-bottom)), 20px);
            padding-left: max(calc(20px + env(safe-area-inset-left)), 20px);
            padding-right: max(calc(20px + env(safe-area-inset-right)), 20px);
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
            width: 100vw;
            min-height: 100vh;
            min-height: 100dvh;
            min-height: -webkit-fill-available;
            box-sizing: border-box;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .main-content.show {
            display: block;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }

        .invitation-card {
            background: #ffffff;
            position: relative;
            padding: 80px 50px;
            margin-bottom: 30px;
            text-align: center;
            overflow: visible;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
        }

        .invitation-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.85);
            z-index: 0;
        }

        .invitation-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('floralPage.png');
            background-size: cover;
            background-position: center center;
            background-repeat: no-repeat;
            z-index: 0;
            pointer-events: none;
            opacity: 0.15;
            mix-blend-mode: multiply;
        }

        .invitation-card > * {
            position: relative;
            z-index: 1;
        }

        .event-title {
            font-family: 'Dancing Script', cursive;
            font-size: 42px;
            color: #b8945f;
            margin-bottom: 30px;
            font-weight: 700;
        }

        .event-date {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            color: #6b7d6b;
            margin: 25px 0 20px;
            font-weight: 400;
            letter-spacing: 1px;
        }

        .countdown-timer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .countdown-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 70px;
        }

        .countdown-number {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            font-weight: 600;
            color: #b8945f;
            line-height: 1;
            margin-bottom: 8px;
            min-width: 60px;
            text-align: center;
        }

        .countdown-label {
            font-family: 'Montserrat', sans-serif;
            font-size: 11px;
            color: #6b7d6b;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 300;
        }

        .countdown-separator {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            color: #b8945f;
            font-weight: 300;
            margin-top: -15px;
        }

        .invitation-message-main {
            font-family: 'Montserrat', sans-serif;
            font-size: 16px;
            color: #6b7d6b;
            margin: 25px 0;
            font-weight: 300;
            line-height: 1.6;
        }

        .confirmation-message {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            color: #6b7d6b;
            margin: 40px auto 0;
            max-width: 500px;
            font-weight: 400;
            line-height: 1.8;
            font-style: italic;
        }

        .invitation-message {
            font-family: 'Montserrat', sans-serif;
            font-size: 15px;
            color: #6b7d6b;
            line-height: 1.8;
            max-width: 500px;
            margin: 30px auto 0;
            font-weight: 300;
            letter-spacing: 0.5px;
        }

        .form-section {
            background: #fafafa;
            padding: 50px 40px;
            margin-top: 60px;
            border-top: 1px solid #e8e8e8;
        }

        .form-group {
            margin-bottom: 30px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #6b7d6b;
            font-weight: 400;
            font-size: 14px;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #d4af37;
            border-radius: 4px;
            font-size: 15px;
            transition: all 0.3s;
            font-family: 'Montserrat', sans-serif;
            background: white;
            color: #2c3e50;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #b8941f;
            box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.15);
        }

        input[type="text"]:invalid:not(:placeholder-shown) {
            border-color: #e74c3c;
        }

        .radio-group {
            display: flex;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            color: #6b7d6b;
            font-size: 14px;
        }

        input[type="radio"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #d4af37;
        }

        .submit-btn {
            background: transparent;
            color: #6b7d6b;
            padding: 15px 45px;
            border: 1.5px solid #d4af37;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 25px;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
        }

        .submit-btn:hover {
            background: #d4af37;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .success-message {
            background: #f0f7f0;
            border: 1px solid #7a9a7a;
            color: #5a7a5a;
            padding: 15px 20px;
            border-radius: 4px;
            margin-bottom: 25px;
            display: none;
            font-family: 'Montserrat', sans-serif;
            font-size: 13px;
            text-align: center;
        }

        .success-message.show {
            display: block;
        }

        /* ========== PANTALLA DE DESPEDIDA ========== */
        .farewell-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            width: 100vw;
            height: 100vh;
            height: 100dvh;
            height: -webkit-fill-available;
            min-height: -webkit-fill-available;
            background: #faf8f3;
            background-image: 
                radial-gradient(circle at 1px 1px, rgba(0,0,0,0.02) 1px, transparent 0);
            background-size: 20px 20px;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 0;
            margin: 0;
            overflow-y: auto;
            box-sizing: border-box;
        }

        .farewell-screen.show {
            display: flex;
        }

        .farewell-screen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-image: url('decoracion.png');
            background-size: 70%;
            background-position: center center;
            background-repeat: no-repeat;
            z-index: 0;
            pointer-events: none;
            opacity: 0.5;
            mix-blend-mode: multiply;
        }

        .farewell-content {
            text-align: center;
            position: relative;
            width: 100%;
            max-width: 500px;
            padding: 20px;
            padding-top: max(calc(20px + env(safe-area-inset-top)), 20px);
            padding-bottom: max(calc(20px + env(safe-area-inset-bottom)), 20px);
            padding-left: max(calc(20px + env(safe-area-inset-left)), 20px);
            padding-right: max(calc(20px + env(safe-area-inset-right)), 20px);
            z-index: 2;
            box-sizing: border-box;
        }

        .farewell-logo-container {
            position: relative;
            margin: 0 auto 30px;
            width: 100%;
            max-width: 350px;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            z-index: 2;
        }

        .farewell-logo {
            width: 100%;
            height: auto;
            max-width: 350px;
            object-fit: contain;
            background: transparent;
            mix-blend-mode: darken;
            filter: 
                contrast(1.3) 
                brightness(0.95)
                drop-shadow(0 2px 8px rgba(0, 0, 0, 0.08));
            position: relative;
            z-index: 2;
        }

        .farewell-logo[src*="logo3"] {
            background: transparent !important;
            mix-blend-mode: darken;
            filter: 
                contrast(1.4) 
                brightness(0.9)
                drop-shadow(0 2px 8px rgba(0, 0, 0, 0.08));
        }

        .farewell-title {
            font-family: 'Dancing Script', cursive;
            font-size: 48px;
            color: #b8945f;
            font-weight: 700;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
        }

        .farewell-message {
            font-family: 'Montserrat', sans-serif;
            font-size: 18px;
            color: #6b7d6b;
            line-height: 1.8;
            position: relative;
            z-index: 2;
            margin: 30px 0;
            font-weight: 300;
        }

        .farewell-submessage {
            font-family: 'Montserrat', sans-serif;
            font-size: 16px;
            color: #6b7d6b;
            line-height: 1.6;
            margin: 40px 0;
            font-weight: 300;
            font-style: italic;
        }

        .farewell-countdown {
            margin: 40px 0;
        }

        .farewell-countdown-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            color: #6b7d6b;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            font-weight: 300;
        }

        /* ========== ANIMACIONES ========== */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        /* Animaciones pantalla de bienvenida */
        .monogram-container {
            animation: scaleIn 1s ease-out 0.3s both;
        }

        .welcome-subtitle {
            animation: fadeInDown 0.8s ease-out 0.6s both;
        }

        .names-welcome {
            animation: fadeInUp 0.8s ease-out 0.9s both;
        }

        .welcome-special-message {
            animation: fadeIn 0.8s ease-out 1.2s both;
        }

        .welcome-separator {
            animation: fadeIn 0.6s ease-out 1.5s both;
        }

        .welcome-date-time {
            animation: fadeInUp 0.8s ease-out 1.8s both;
        }

        /* Animaciones de botones removidas */

        /* Arreglos florales en animaciones */
        /* Arreglos florales removidos */

        /* Animaciones contenido principal */
        .invitation-card {
            animation: scaleIn 0.8s ease-out;
        }

        .event-title {
            animation: fadeInDown 0.8s ease-out 0.3s both;
        }

        .invitation-message-main {
            animation: fadeInUp 0.8s ease-out 0.5s both;
        }

        .event-date {
            animation: fadeInUp 0.8s ease-out 0.7s both;
        }

        .countdown-timer {
            animation: fadeInUp 0.8s ease-out 0.9s both;
        }

        .countdown-item {
            animation: fadeIn 0.6s ease-out 1.1s both;
        }

        .invitation-message {
            animation: fadeInUp 0.8s ease-out 1.3s both;
        }

        .confirmation-message {
            animation: fadeInUp 0.8s ease-out 1.5s both;
        }

        .form-section {
            animation: fadeInUp 0.8s ease-out 1.7s both;
        }

        .form-group {
            animation: slideIn 0.6s ease-out 1.9s both;
        }

        /* Animaciones de botones removidas */

        /* ========== ANUNCIO INFORMATIVO ========== */
        .info-announcement {
            background: linear-gradient(135deg, #f5f0e8 0%, #e8e0d4 100%);
            border-left: 4px solid #8b7355;
            padding: 15px 20px;
            margin: 25px 0 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(139, 115, 85, 0.1);
        }

        .info-announcement p {
            margin: 0;
            color: #6b7d6b;
            font-size: 14px;
            line-height: 1.6;
            font-family: 'Montserrat', sans-serif;
        }

        /* ========== BOTÓN Y MODAL PARA MODIFICAR ACOMPAÑANTES ========== */
        .modify-companions-btn,
        .check-passes-btn {
            background: transparent;
            color: #6b7d6b;
            padding: 12px 35px;
            border: 1.5px solid #8b7355;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            font-family: 'Montserrat', sans-serif;
            width: 100%;
        }

        .modify-companions-btn:hover,
        .check-passes-btn:hover {
            background: #8b7355;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 115, 85, 0.3);
        }

        .modify-companions-btn:active,
        .check-passes-btn:active {
            transform: translateY(0);
        }
        
        .guest-passes-info {
            margin-top: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            text-align: center;
        }
        
        .passes-count-display {
            font-size: 32px;
            font-weight: 600;
            color: #8b7355;
            margin: 10px 0;
        }
        
        .passes-label {
            font-size: 18px;
            color: #6b7d6b;
            margin-left: 5px;
        }

        .companions-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 3000;
            overflow-y: auto;
            padding: 20px;
            box-sizing: border-box;
        }

        .companions-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .companions-modal-content {
            background: #ffffff;
            border-radius: 8px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .companions-modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid #e8e8e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .companions-modal-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            color: #2c2c2c;
            margin: 0;
            font-weight: 600;
        }

        .companions-modal-close {
            background: none;
            border: none;
            font-size: 32px;
            color: #6b7d6b;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            line-height: 1;
            transition: color 0.3s;
        }

        .companions-modal-close:hover {
            color: #2c2c2c;
        }

        .companions-modal-body {
            padding: 30px;
        }

        .search-btn {
            background: #8b7355;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            font-family: 'Montserrat', sans-serif;
            width: 100%;
        }

        .search-btn:hover {
            background: #6b5a45;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 115, 85, 0.3);
        }

        .search-btn:active {
            transform: translateY(0);
        }

        .guest-search-result {
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid #e8e8e8;
        }

        .guest-info {
            margin-bottom: 25px;
        }

        .guest-info h3 {
            font-family: 'Playfair Display', serif;
            font-size: 20px;
            color: #2c2c2c;
            margin: 0 0 10px;
            font-weight: 600;
        }

        .guest-attendance-info {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            color: #6b7d6b;
            margin: 5px 0;
        }

        .guest-companions-info {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            color: #2c2c2c;
            margin: 15px 0;
            padding: 15px;
            background: #f8f8f8;
            border-left: 3px solid #8b7355;
            border-radius: 4px;
        }

        .guest-companions-info p {
            margin: 5px 0;
        }

        .companions-count-display {
            font-size: 24px;
            font-weight: 600;
            color: #8b7355;
            margin: 10px 0;
            display: flex;
            align-items: baseline;
            gap: 5px;
        }

        .companions-count-display span:first-child {
            font-size: 32px;
            color: #6b5a45;
        }

        .companions-label {
            font-size: 16px;
            font-weight: 400;
            color: #6b7d6b;
        }

        .companions-radio-group {
            flex-direction: column;
            gap: 15px;
        }

        .companions-message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            text-align: center;
        }

        .companions-message.success {
            background: #f0f7f0;
            border: 1px solid #7a9a7a;
            color: #5a7a5a;
        }

        .companions-message.error {
            background: #fff0f0;
            border: 1px solid #e74c3c;
            color: #c0392b;
        }

        @media (max-width: 480px) {
            .info-announcement {
                padding: 12px 15px;
                margin: 20px 0 15px 0;
            }

            .info-announcement p {
                font-size: 13px;
            }

            .companions-modal {
                padding: 10px;
            }

            .companions-modal-content {
                max-height: 95vh;
            }

            .companions-modal-header {
                padding: 20px;
            }

            .companions-modal-header h2 {
                font-size: 20px;
            }

            .companions-modal-body {
                padding: 20px;
            }

            .modify-companions-btn {
                padding: 12px 25px;
                font-size: 12px;
            }
        }

        /* Animaciones pantalla de despedida */
        .farewell-logo-container {
            animation: scaleIn 1s ease-out 0.2s both;
        }

        .farewell-title {
            animation: fadeInUp 0.8s ease-out 0.5s both;
        }

        .farewell-message {
            animation: fadeInUp 0.8s ease-out 0.7s both;
        }

        .farewell-submessage {
            animation: fadeInUp 0.8s ease-out 0.9s both;
        }

        .farewell-countdown {
            animation: fadeInUp 0.8s ease-out 1.1s both;
        }

        .farewell-countdown .countdown-item {
            animation: scaleIn 0.5s ease-out 1.3s both;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 768px) {
            .invitation-card {
                padding: 50px 35px;
            }

            .welcome-screen::before {
                background-size: 90%;
                opacity: 0.45;
            }

            .invitation-card::after {
                background-size: cover;
                opacity: 0.12;
            }

            .farewell-screen::before {
                background-size: 90%;
                opacity: 0.45;
            }
        }

        @media (max-width: 480px) {
            .welcome-screen {
                padding: 0 !important;
                margin: 0 !important;
                overflow: hidden;
                height: 100vh !important;
                height: 100dvh !important;
                height: -webkit-fill-available !important;
                min-height: 100vh !important;
                min-height: 100dvh !important;
                min-height: -webkit-fill-available !important;
                width: 100vw !important;
                max-width: 100vw !important;
                justify-content: center;
                align-items: center;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
            }

            .welcome-screen::before {
                opacity: 0.5;
                background-size: cover;
                background-position: center center;
            }

            .welcome-screen::after {
                display: none !important;
            }

            .farewell-screen::before {
                opacity: 0.5;
                background-size: cover;
                background-position: center center;
            }

            /* Contenedor welcome-content eliminado */

            .monogram-container {
                max-width: 100%;
                width: 100%;
                margin-bottom: 15px;
                padding: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-shrink: 0;
            }

            .monogram-svg {
                max-width: 280px;
                max-height: 280px;
                width: 280px;
                height: auto;
            }

            .welcome-subtitle {
                font-size: 15px;
                width: 100%;
                padding: 0 15px;
                box-sizing: border-box;
                margin-bottom: 10px;
                flex-shrink: 0;
            }

            .names-welcome {
                font-size: 28px;
                width: 100%;
                padding: 0 20px;
                box-sizing: border-box;
                margin-bottom: 20px;
                flex-shrink: 0;
            }

            .ampersand {
                font-size: 26px;
            }

            .welcome-special-message {
                font-size: 14px;
                margin: 12px 0;
                width: 100%;
                padding: 0 15px;
                box-sizing: border-box;
                flex-shrink: 0;
            }

            .welcome-separator {
                width: 160px;
                margin: 15px auto;
                flex-shrink: 0;
            }

            .welcome-date-time {
                width: 100%;
                padding: 0 15px;
                box-sizing: border-box;
                margin-top: 10px;
                flex-shrink: 0;
            }

            .welcome-date {
                font-size: 15px;
            }

            .welcome-btn {
                padding: 16px 35px;
                font-size: 15px;
                letter-spacing: 2px;
                width: auto;
                min-width: 220px;
                position: relative;
                z-index: 10;
                display: block;
                visibility: visible;
                opacity: 1;
                margin: 20px auto 0;
                flex-shrink: 0;
            }

            .main-content {
                padding: 10px;
                width: 100%;
                width: 100vw;
                max-width: 100%;
                box-sizing: border-box;
            }

            .container {
                width: 100%;
                max-width: 100%;
                padding: 0;
                margin: 0;
                box-sizing: border-box;
            }

            .invitation-card {
                width: 100%;
                box-sizing: border-box;
            }

            .invitation-card {
                padding: 40px 20px;
                margin-bottom: 20px;
            }

            .invitation-card::after {
                background-size: cover;
                opacity: 0.12;
            }

            .event-title {
                font-size: 32px;
                margin-bottom: 25px;
            }

            .event-date {
                font-size: 18px;
                margin: 20px 0 15px;
            }

            .countdown-timer {
                gap: 10px;
                margin: 20px 0;
            }

            .countdown-item {
                min-width: 55px;
            }

            .countdown-number {
                font-size: 24px;
                min-width: 50px;
            }

            .countdown-label {
                font-size: 9px;
            }

            .countdown-separator {
                font-size: 20px;
                margin-top: -10px;
            }

            .invitation-message-main {
                font-size: 14px;
                margin: 20px 0;
            }

            .invitation-message {
                font-size: 13px;
                margin: 25px auto 0;
            }

            .confirmation-message {
                font-size: 12px;
                margin: 30px auto 0;
            }

            .form-section {
                padding: 30px 20px;
                margin-top: 30px;
            }

            .form-group {
                margin-bottom: 25px;
            }

            label {
                font-size: 12px;
                letter-spacing: 0.5px;
                margin-bottom: 8px;
            }

            input[type="text"] {
                padding: 10px 12px;
                font-size: 14px;
            }

            .radio-group {
                gap: 12px;
            }

            .radio-option {
                font-size: 13px;
            }

            input[type="radio"] {
                width: 16px;
                height: 16px;
            }

            .submit-btn {
                padding: 12px 30px;
                font-size: 12px;
                letter-spacing: 1.5px;
                width: 100%;
                margin-top: 20px;
            }

            .farewell-logo-container {
                max-width: 280px;
                margin-bottom: 25px;
            }

            .farewell-logo {
                max-width: 280px;
            }

            .farewell-title {
                font-size: 32px;
            }

            .farewell-message {
                font-size: 14px;
            }

            .farewell-submessage {
                font-size: 13px;
            }

            .farewell-countdown-title {
                font-size: 12px;
            }

            .farewell-countdown .countdown-number {
                font-size: 20px;
            }

            .farewell-countdown .countdown-label {
                font-size: 9px;
            }
        }

        @media (max-width: 360px) {
            .welcome-screen {
                padding: 0 !important;
                margin: 0 !important;
                overflow: hidden;
                height: 100vh !important;
                height: 100dvh !important;
                height: -webkit-fill-available !important;
                min-height: 100vh !important;
                min-height: 100dvh !important;
                min-height: -webkit-fill-available !important;
                width: 100vw !important;
                max-width: 100vw !important;
                justify-content: center;
                align-items: center;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
            }

            .welcome-screen::before {
                opacity: 0.5;
                background-size: cover;
                background-position: center center;
            }

            .welcome-screen::after {
                display: none !important;
            }

            .farewell-screen::before {
                opacity: 0.5;
                background-size: cover;
                background-position: center center;
            }

            /* Contenedor welcome-content eliminado */

            .monogram-container {
                max-width: 100%;
                width: 100%;
                margin-bottom: 25px;
                padding: 15px;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-shrink: 0;
            }

            .monogram-svg {
                max-width: 280px;
                max-height: 280px;
                width: 280px;
                height: auto;
            }

            .names-welcome {
                font-size: 26px;
                width: 100%;
                padding: 0 20px;
                box-sizing: border-box;
                margin-bottom: 20px;
                flex-shrink: 0;
            }

            .welcome-subtitle {
                font-size: 16px;
                padding: 0 20px;
                margin-bottom: 15px;
                flex-shrink: 0;
                letter-spacing: 2px;
            }

            .welcome-special-message {
                font-size: 15px;
                padding: 0 25px;
                margin: 15px 0;
                flex-shrink: 0;
                max-width: 100%;
            }

            .welcome-date-time {
                padding: 0 20px;
                margin-top: 20px;
                flex-shrink: 0;
            }

            .welcome-date {
                font-size: 17px;
                letter-spacing: 1.5px;
            }

            .welcome-separator {
                width: 140px;
                margin: 20px auto;
                flex-shrink: 0;
            }

            .welcome-separator::before,
            .welcome-separator::after {
                font-size: 10px;
            }

            .welcome-separator::before {
                left: -20px;
            }

            .welcome-separator::after {
                right: -20px;
            }

            .welcome-btn {
                min-width: 200px;
                padding: 14px 35px;
                font-size: 12px;
                letter-spacing: 2.5px;
                position: relative;
                z-index: 2;
                display: block;
                visibility: visible;
                opacity: 1;
                margin: 30px auto 0;
                flex-shrink: 0;
            }

            .invitation-card {
                padding: 30px 15px;
            }

            .invitation-card::after {
                background-size: cover;
                opacity: 0.1;
            }

            .event-title {
                font-size: 28px;
            }

            .event-date {
                font-size: 16px;
            }

            .countdown-number {
                font-size: 20px;
                min-width: 45px;
            }

            .countdown-label {
                font-size: 8px;
            }

            .countdown-separator {
                font-size: 18px;
            }

            .invitation-message-main {
                font-size: 13px;
            }

            .invitation-message {
                font-size: 12px;
            }

            .confirmation-message {
                font-size: 11px;
            }

            .form-section {
                padding: 25px 15px;
            }

            .submit-btn {
                padding: 10px 25px;
                font-size: 11px;
            }

            .farewell-title {
                font-size: 32px;
            }

            .farewell-message {
                font-size: 14px;
            }

            .farewell-submessage {
                font-size: 13px;
            }

            .farewell-countdown-title {
                font-size: 12px;
            }

            .farewell-countdown .countdown-number {
                font-size: 20px;
            }

            .farewell-countdown .countdown-label {
                font-size: 9px;
            }
        }
    </style>
</head>
<body>
    <!-- Pantalla de bienvenida -->
    <div class="welcome-screen" id="welcomeScreen">
        <!-- Monograma PNG -->
        <div class="monogram-container">
            <img src="logo3.png" alt="Monograma R & D" class="monogram-svg">
        </div>

        <!-- Título -->
        <div class="welcome-subtitle">Nuestra Boda</div>

        <!-- Nombres -->
        <div class="names-welcome">
            <span id="name1Welcome">José Raúl Trinidad Herrera</span>
            <span class="ampersand"><br>y<br></span>
            <span id="name2Welcome">Dioselyn Palma Hernández</span>
        </div>

        <!-- Mensaje especial -->
        <div class="welcome-special-message">¡No faltes en este día tan especial!</div>

        <!-- Línea separadora -->
        <div class="welcome-separator"></div>

        <!-- Fecha y hora -->
        <div class="welcome-date-time">
            <div class="welcome-date" id="welcomeDate">02 / Mayo / 2026</div>
        </div>

        <!-- Botón -->
        <button class="welcome-btn" id="welcomeBtn">Continuar</button>
    </div>

    <!-- Contenido principal (Invitación) -->
    <div class="main-content" id="mainContent">
        <div class="container">
            <!-- Tarjeta de invitación -->
            <div class="invitation-card">
                <!-- Título principal -->
                <div class="event-title">¡Nos casamos! </div>

                <!-- Mensaje principal -->
                <div class="invitation-message-main">
                    Queremos reservar esta fecha contigo:
                </div>

                <!-- Fecha -->
                <div class="event-date" id="eventDate">02 de mayo de 2026</div>

                <!-- Temporizador de cuenta regresiva -->
                <div class="countdown-timer" id="countdownTimer">
                    <div class="countdown-item">
                        <div class="countdown-number" id="days">00</div>
                        <div class="countdown-label">Días</div>
                    </div>
                    <div class="countdown-separator">:</div>
                    <div class="countdown-item">
                        <div class="countdown-number" id="hours">00</div>
                        <div class="countdown-label">Horas</div>
                    </div>
                    <div class="countdown-separator">:</div>
                    <div class="countdown-item">
                        <div class="countdown-number" id="minutes">00</div>
                        <div class="countdown-label">Minutos</div>
                    </div>
                    <div class="countdown-separator">:</div>
                    <div class="countdown-item">
                        <div class="countdown-number" id="seconds">00</div>
                        <div class="countdown-label">Segundos</div>
                    </div>
                </div>

                <!-- Mensaje de invitación -->
                <div class="invitation-message">
                    En los próximos meses recibirás<br>
                    nuestra invitación formal.
                </div>

                <!-- Mensaje de confirmación -->
                <div class="confirmation-message">
                    Por favor confírmanos si podremos contar con tu presencia.
                </div>

                <!-- Mensaje de éxito -->
                <div class="success-message" id="successMessage">
                    ✓ ¡Gracias por confirmar! Tu respuesta ha sido registrada exitosamente.
                </div>

                <!-- Formulario de confirmación -->
                <div class="form-section">
                    <form id="confirmationForm">
                        <div class="form-group">
                            <label for="guestName">Nombre completo *</label>
                            <input type="text" id="guestName" name="guestName" required placeholder="Ingresa tu nombre completo">
                        </div>

                        <div class="form-group">
                            <label>¿Confirmas tu asistencia? *</label>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="attendance" value="yes" required>
                                    <span>✓ Sí, asistiré con mucho gusto</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="attendance" value="no" required>
                                    <span>✗ Lo siento, no podré asistir</span>
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="submit-btn">Confirmar Asistencia</button>
                    </form>
                    
                    <!-- Anuncio informativo -->
                    <div class="info-announcement">
                        <p>💡 Si ya confirmaste tu asistencia, puedes consultar o modificar tus pases usando los botones a continuación.</p>
                    </div>
                    
                    <!-- Botón para consultar pases -->
                    <button type="button" class="check-passes-btn" id="checkPassesBtn">Consultar Pases</button>
                    
                    <!-- Botón para modificar acompañantes -->
                    <button type="button" class="modify-companions-btn" id="modifyCompanionsBtn">Modificar Acompañantes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para modificar acompañantes -->
    <div class="companions-modal" id="companionsModal">
        <div class="companions-modal-content">
            <div class="companions-modal-header">
                <h2>Modificar Acompañantes</h2>
                <button class="companions-modal-close" id="companionsModalClose">&times;</button>
            </div>
            <div class="companions-modal-body">
                <div class="form-group">
                    <label for="searchGuestName">Buscar invitado por nombre completo *</label>
                    <input type="text" id="searchGuestName" placeholder="Ingrese su nombre completo">
                    <button type="button" class="search-btn" id="searchGuestBtn">Buscar</button>
                </div>
                
                <div id="guestSearchResult" class="guest-search-result" style="display: none;">
                    <div class="guest-info">
                        <h3 id="foundGuestName"></h3>
                        <p class="guest-attendance-info" id="guestAttendanceInfo"></p>
                        <div class="guest-companions-info">
                            <p><strong>Cantidad de acompañantes:</strong></p>
                            <p class="companions-count-display">
                                <span id="currentCompanionsCount">2</span>
                                <span class="companions-label" id="companionsLabel">acompañantes</span>
                            </p>
                        </div>
                    </div>
                    
                    <div id="companionsSelectionSection">
                        <div class="form-group">
                            <label>Selecciona la nueva cantidad de acompañantes:</label>
                            <div class="radio-group companions-radio-group" id="companionsRadioGroup">
                                <!-- Las opciones se generan dinámicamente según la cantidad actual -->
                            </div>
                        </div>
                        
                        <button type="button" class="submit-btn" id="saveCompanionsBtn">Guardar Cambios</button>
                    </div>
                </div>
                
                <div id="companionsMessage" class="companions-message" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Modal para consultar pases -->
    <div class="companions-modal" id="passesModal">
        <div class="companions-modal-content">
            <div class="companions-modal-header">
                <h2>Consultar Pases</h2>
                <button class="companions-modal-close" id="passesModalClose">&times;</button>
            </div>
            <div class="companions-modal-body">
                <div class="form-group">
                    <label for="searchPassesName">Buscar invitado por nombre completo *</label>
                    <input type="text" id="searchPassesName" placeholder="Ingrese su nombre completo">
                    <button type="button" class="search-btn" id="searchPassesBtn">Buscar</button>
                </div>
                
                <div id="passesSearchResult" class="guest-search-result" style="display: none;">
                    <div class="guest-info">
                        <h3 id="foundPassesGuestName"></h3>
                        <div class="guest-passes-info">
                            <p><strong>Cantidad de pases asignados:</strong></p>
                            <p class="passes-count-display">
                                <span id="currentPassesCount">0</span>
                                <span class="passes-label" id="passesLabel">pases</span>
                            </p>
                        </div>
                    </div>
                </div>
                
                <div id="passesMessage" class="companions-message" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- Pantalla de despedida elegante -->
    <div class="farewell-screen" id="farewellScreen">
        <div class="farewell-content">
            <!-- Logo -->
            <div class="farewell-logo-container">
                <img src="logo3.png" alt="Monograma R & D" class="farewell-logo">
            </div>

            <h1 class="farewell-title" id="farewellTitle">¡Gracias!</h1>
            <p class="farewell-message" id="farewellMessage">
                Tu respuesta ha sido registrada exitosamente.
            </p>
            <p class="farewell-submessage" id="farewellSubmessage">
                Estamos emocionados de compartir este día especial contigo.
            </p>
            
            <!-- Cuenta regresiva en la despedida -->
            <div class="farewell-countdown" id="farewellCountdown">
                <div class="farewell-countdown-title">Nos vemos en:</div>
                <div class="countdown-timer" id="farewellCountdownTimer">
                    <div class="countdown-item">
                        <div class="countdown-number" id="farewellDays">00</div>
                        <div class="countdown-label">Días</div>
                    </div>
                    <div class="countdown-separator">:</div>
                    <div class="countdown-item">
                        <div class="countdown-number" id="farewellHours">00</div>
                        <div class="countdown-label">Horas</div>
                    </div>
                    <div class="countdown-separator">:</div>
                    <div class="countdown-item">
                        <div class="countdown-number" id="farewellMinutes">00</div>
                        <div class="countdown-label">Minutos</div>
                    </div>
                    <div class="countdown-separator">:</div>
                    <div class="countdown-item">
                        <div class="countdown-number" id="farewellSeconds">00</div>
                        <div class="countdown-label">Segundos</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== CONTROL DE PANTALLAS ==========
        const welcomeScreen = document.getElementById('welcomeScreen');
        const mainContent = document.getElementById('mainContent');
        const farewellScreen = document.getElementById('farewellScreen');
        const welcomeBtn = document.getElementById('welcomeBtn');

        // Mostrar contenido principal al hacer clic en "Continuar"
        welcomeBtn.addEventListener('click', function() {
            welcomeScreen.classList.add('hidden');
            mainContent.classList.add('show');
            document.body.classList.add('main-content-visible');
            // Start invitation countdown here
            updateCountdown();
            countdownInterval = setInterval(updateCountdown, 1000);
        });

        // Permitir también hacer clic en el área de la pantalla para continuar
        welcomeScreen.addEventListener('click', function(e) {
            if (e.target !== welcomeBtn && !e.target.closest('.welcome-btn') && !e.target.closest('.monogram-container')) {
                welcomeBtn.click();
            }
        });

        // ========== TEMPORIZADOR DE CUENTA REGRESIVA (INVITACIÓN) ==========
        function updateCountdown() {
            const weddingDate = new Date(2026, 4, 2, 0, 0, 0);
            const now = new Date();
            const difference = weddingDate - now;

            if (difference <= 0) {
                const daysEl = document.getElementById('days');
                const hoursEl = document.getElementById('hours');
                const minutesEl = document.getElementById('minutes');
                const secondsEl = document.getElementById('seconds');
                
                if (daysEl) daysEl.textContent = '00';
                if (hoursEl) hoursEl.textContent = '00';
                if (minutesEl) minutesEl.textContent = '00';
                if (secondsEl) secondsEl.textContent = '00';
                return;
            }

            const days = Math.floor(difference / (1000 * 60 * 60 * 24));
            const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((difference % (1000 * 60)) / 1000);

            const daysEl = document.getElementById('days');
            const hoursEl = document.getElementById('hours');
            const minutesEl = document.getElementById('minutes');
            const secondsEl = document.getElementById('seconds');

            if (daysEl) daysEl.textContent = String(days).padStart(2, '0');
            if (hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');
            if (minutesEl) minutesEl.textContent = String(minutes).padStart(2, '0');
            if (secondsEl) secondsEl.textContent = String(seconds).padStart(2, '0');
        }

        // Iniciar cuenta regresiva solo cuando se muestre el contenido principal
        let countdownInterval;
        welcomeBtn.addEventListener('click', function() {
            updateCountdown();
            if (countdownInterval) clearInterval(countdownInterval);
            countdownInterval = setInterval(updateCountdown, 1000);
        });

        // ========== INICIALIZACIÓN DE DATOS ==========
        let guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
        let useSupabase = false;

        async function initializeData() {
            if (typeof initSupabaseService === 'function' && typeof supabase !== 'undefined') {
                useSupabase = initSupabaseService();
                if (useSupabase && supabaseService) {
                    try {
                        guestList = await supabaseService.getAllGuests();
                        localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                        return;
                    } catch (error) {
                        console.error('Error al cargar desde Supabase, usando localStorage:', error);
                        useSupabase = false;
                    }
                }
            }
            guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeData);
        } else {
            setTimeout(initializeData, 100);
        }

        // ========== MANEJO DEL FORMULARIO ==========
        const form = document.getElementById('confirmationForm');
        const guestNameInput = document.getElementById('guestName');

        if (form) {
            form.addEventListener('submit', async function(e) {
                e.preventDefault();

                // Validar nombre
                const guestName = guestNameInput.value.trim();
                
                if (!guestName || guestName.length < 2) {
                    guestNameInput.style.borderColor = '#e74c3c';
                    guestNameInput.focus();
                    
                    let errorMsg = document.getElementById('nameError');
                    if (!errorMsg) {
                        errorMsg = document.createElement('div');
                        errorMsg.id = 'nameError';
                        errorMsg.style.cssText = 'color: #e74c3c; font-size: 13px; margin-top: 5px; text-align: left;';
                        errorMsg.textContent = 'Por favor ingresa tu nombre completo (mínimo 2 caracteres)';
                        guestNameInput.parentElement.appendChild(errorMsg);
                    }
                    
                    guestNameInput.addEventListener('input', function() {
                        if (this.value.trim().length >= 2) {
                            this.style.borderColor = '#d4af37';
                            if (errorMsg) {
                                errorMsg.remove();
                            }
                        }
                    }, { once: true });
                    
                    return;
                }

                // Validar asistencia
                const selectedAttendance = document.querySelector('input[name="attendance"]:checked');
                if (!selectedAttendance) {
                    alert('Por favor selecciona si asistirás o no');
                    return;
                }

                const formData = {
                    name: guestName,
                    attendance: selectedAttendance.value
                };

                // Mostrar indicador de carga
                const submitBtn = form.querySelector('.submit-btn');
                const originalBtnText = submitBtn.textContent;
                submitBtn.disabled = true;
                submitBtn.textContent = 'Guardando...';

                try {
                    let savedGuest;

                    // Intentar guardar en Supabase si está disponible
                    if (useSupabase && supabaseService) {
                        try {
                            savedGuest = await supabaseService.addGuest(formData);
                            guestList.push(savedGuest);
                            localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                        } catch (supabaseError) {
                            console.error('Error al guardar en Supabase:', supabaseError);
                            // Si no asistirá, cantidad_acompañante = 0, de lo contrario = 2
                            const cantidadAcompañante = formData.attendance === 'no' ? 0 : 2;
                            savedGuest = {
                                id: Date.now(),
                                name: formData.name,
                                attendance: formData.attendance,
                                cantidad_acompañante: cantidadAcompañante,
                                timestamp: new Date().toLocaleString('es-MX')
                            };
                            guestList.push(savedGuest);
                            localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                        }
                    } else {
                        // Si no asistirá, cantidad_acompañante = 0, de lo contrario = 2
                        const cantidadAcompañante = formData.attendance === 'no' ? 0 : 2;
                        savedGuest = {
                            id: Date.now(),
                            name: formData.name,
                            attendance: formData.attendance,
                            cantidad_acompañante: cantidadAcompañante,
                            timestamp: new Date().toLocaleString('es-MX')
                        };
                        guestList.push(savedGuest);
                        localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                    }

                    // Ocultar contenido principal y mostrar pantalla de despedida
                    mainContent.classList.remove('show');
                    document.body.classList.remove('main-content-visible');
                    farewellScreen.classList.add('show');

                    // Personalizar mensaje según la respuesta
                    const farewellTitle = document.getElementById('farewellTitle');
                    const farewellMessage = document.getElementById('farewellMessage');
                    const farewellSubmessage = document.getElementById('farewellSubmessage');
                    const farewellCountdown = document.getElementById('farewellCountdown');

                    if (formData.attendance === 'yes') {
                        // Si hay un mensaje personalizado desde invitados_maestro, usarlo
                        if (savedGuest && savedGuest.mensaje) {
                            const mensajeLineas = savedGuest.mensaje.split('\n');
                            farewellTitle.textContent = mensajeLineas[0] || `¡Gracias por confirmar, ${formData.name}!`; // Primera línea del mensaje
                            farewellMessage.textContent = mensajeLineas[1] || 'Tu asistencia ha sido registrada exitosamente.'; // Segunda línea
                            farewellSubmessage.textContent = 'Estamos emocionados de compartir este día especial contigo.';
                            console.log('Mostrando mensaje personalizado:', savedGuest.mensaje);
                        } else {
                            farewellTitle.textContent = `¡Gracias por confirmar, ${formData.name}!`;
                            farewellMessage.textContent = 'Tu asistencia ha sido registrada exitosamente.';
                            farewellSubmessage.textContent = 'Estamos emocionados de compartir este día especial contigo.';
                            console.log('No se encontró mensaje personalizado. savedGuest:', savedGuest);
                        }
                        if (farewellCountdown) {
                            farewellCountdown.style.display = 'block';
                        }
                    } else {
                        farewellTitle.textContent = `Gracias por tu respuesta, ${formData.name}`;
                        farewellMessage.textContent = 'Lamentamos profundamente tu inasistencia.';
                        farewellSubmessage.textContent = 'Aunque no podrás acompañarnos, agradecemos que nos hayas informado.';
                        if (farewellCountdown) {
                            farewellCountdown.style.display = 'none';
                        }
                    }

                    // Iniciar cuenta regresiva en pantalla de despedida si confirmó asistencia
                    if (formData.attendance === 'yes') {
                        updateFarewellCountdown();
                        setInterval(updateFarewellCountdown, 1000);
                    }

                } catch (error) {
                    console.error('Error al guardar invitado:', error);
                    alert('Hubo un error al guardar. Por favor intenta nuevamente.');
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalBtnText;
                }
            });
        }

        // ========== TEMPORIZADOR DE CUENTA REGRESIVA (DESPEDIDA) ==========
        function updateFarewellCountdown() {
            const weddingDate = new Date(2026, 4, 2, 0, 0, 0);
            const now = new Date();
            const difference = weddingDate - now;

            if (difference <= 0) {
                const farewellDaysEl = document.getElementById('farewellDays');
                const farewellHoursEl = document.getElementById('farewellHours');
                const farewellMinutesEl = document.getElementById('farewellMinutes');
                const farewellSecondsEl = document.getElementById('farewellSeconds');
                
                if (farewellDaysEl) farewellDaysEl.textContent = '00';
                if (farewellHoursEl) farewellHoursEl.textContent = '00';
                if (farewellMinutesEl) farewellMinutesEl.textContent = '00';
                if (farewellSecondsEl) farewellSecondsEl.textContent = '00';
                return;
            }

            const days = Math.floor(difference / (1000 * 60 * 60 * 24));
            const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((difference % (1000 * 60)) / 1000);

            const farewellDaysEl = document.getElementById('farewellDays');
            const farewellHoursEl = document.getElementById('farewellHours');
            const farewellMinutesEl = document.getElementById('farewellMinutes');
            const farewellSecondsEl = document.getElementById('farewellSeconds');

            if (farewellDaysEl) farewellDaysEl.textContent = String(days).padStart(2, '0');
            if (farewellHoursEl) farewellHoursEl.textContent = String(hours).padStart(2, '0');
            if (farewellMinutesEl) farewellMinutesEl.textContent = String(minutes).padStart(2, '0');
            if (farewellSecondsEl) farewellSecondsEl.textContent = String(seconds).padStart(2, '0');
        }

        // ========== MODAL PARA MODIFICAR ACOMPAÑANTES ==========
        const modifyCompanionsBtn = document.getElementById('modifyCompanionsBtn');
        const companionsModal = document.getElementById('companionsModal');
        const companionsModalClose = document.getElementById('companionsModalClose');
        const searchGuestBtn = document.getElementById('searchGuestBtn');
        const searchGuestNameInput = document.getElementById('searchGuestName');
        const guestSearchResult = document.getElementById('guestSearchResult');
        const saveCompanionsBtn = document.getElementById('saveCompanionsBtn');
        const companionsMessage = document.getElementById('companionsMessage');
        let currentGuestId = null;
        let currentGuestCantidad = 2;

        // Abrir modal
        if (modifyCompanionsBtn) {
            modifyCompanionsBtn.addEventListener('click', function() {
                companionsModal.classList.add('show');
                document.body.style.overflow = 'hidden';
                // Limpiar formulario
                searchGuestNameInput.value = '';
                guestSearchResult.style.display = 'none';
                companionsMessage.style.display = 'none';
                currentGuestId = null;
                
                // Resetear visibilidad de opciones
                const companionsSelectionSection = document.getElementById('companionsSelectionSection');
                const companionsRadioGroup = document.getElementById('companionsRadioGroup');
                
                // Limpiar opciones al abrir el modal (se generarán cuando se busque un invitado)
                companionsSelectionSection.style.display = 'none';
                companionsRadioGroup.innerHTML = '';
            });
        }

        // Cerrar modal
        if (companionsModalClose) {
            companionsModalClose.addEventListener('click', function() {
                companionsModal.classList.remove('show');
                document.body.style.overflow = '';
            });
        }

        // Cerrar modal al hacer clic fuera
        if (companionsModal) {
            companionsModal.addEventListener('click', function(e) {
                if (e.target === companionsModal) {
                    companionsModal.classList.remove('show');
                    document.body.style.overflow = '';
                }
            });
        }

        // Buscar invitado
        if (searchGuestBtn) {
            searchGuestBtn.addEventListener('click', async function() {
                const searchName = searchGuestNameInput.value.trim();
                
                if (!searchName || searchName.length < 2) {
                    showCompanionsMessage('Por favor ingresa un nombre válido (mínimo 2 caracteres)', 'error');
                    return;
                }

                // Mostrar indicador de carga
                searchGuestBtn.disabled = true;
                searchGuestBtn.textContent = 'Buscando...';

                try {
                    let guest = null;

                    // Intentar buscar en Supabase si está disponible
                    if (useSupabase && supabaseService) {
                        try {
                            guest = await supabaseService.findGuestByName(searchName);
                        } catch (error) {
                            console.error('Error al buscar en Supabase:', error);
                            // Intentar buscar en localStorage como respaldo
                            guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
                            guest = guestList.find(g => g.name.toLowerCase() === searchName.toLowerCase());
                        }
                    } else {
                        // Buscar en localStorage
                        guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
                        guest = guestList.find(g => g.name.toLowerCase() === searchName.toLowerCase());
                    }

                    if (!guest) {
                        showCompanionsMessage('No se encontró ningún invitado con ese nombre. Por favor verifica el nombre completo.', 'error');
                        guestSearchResult.style.display = 'none';
                        return;
                    }

                    // Si el invitado no asistirá, no mostrar resultado
                    if (guest.attendance === 'no') {
                        showCompanionsMessage('Este invitado ha indicado que no asistirá. No se puede modificar la cantidad de acompañantes.', 'error');
                        guestSearchResult.style.display = 'none';
                        return;
                    }

                    // Mostrar resultado
                    currentGuestId = guest.id;
                    // Usar ?? en lugar de || para que 0 no se convierta en 2
                    // Si cantidad_acompañante es null o undefined, usar 2, pero si es 0, mantener 0
                    currentGuestCantidad = (guest.cantidad_acompañante !== null && guest.cantidad_acompañante !== undefined) 
                        ? guest.cantidad_acompañante 
                        : 2;
                    
                    document.getElementById('foundGuestName').textContent = guest.name;
                    document.getElementById('currentCompanionsCount').textContent = currentGuestCantidad;
                    
                    // Actualizar etiqueta según la cantidad
                    const companionsLabel = document.getElementById('companionsLabel');
                    if (currentGuestCantidad === 0) {
                        companionsLabel.textContent = 'acompañantes';
                    } else if (currentGuestCantidad === 1) {
                        companionsLabel.textContent = 'invitado';
                    } else {
                        companionsLabel.textContent = 'acompañantes';
                    }
                    
                    const attendanceText = guest.attendance === 'yes' 
                        ? '✓ Asistencia confirmada' 
                        : '✗ No asistirá';
                    document.getElementById('guestAttendanceInfo').textContent = attendanceText;
                    
                    // Obtener referencias a los elementos
                    const companionsSelectionSection = document.getElementById('companionsSelectionSection');
                    const companionsRadioGroup = document.getElementById('companionsRadioGroup');
                    
                    // Si el invitado tiene 0 acompañantes, ocultar toda la sección de selección
                    if (currentGuestCantidad === 0) {
                        companionsSelectionSection.style.display = 'none';
                    } else {
                        // Mostrar la sección de selección
                        companionsSelectionSection.style.display = 'block';
                        
                        // Generar opciones dinámicamente (solo opciones de disminución)
                        generateCompanionsOptions(currentGuestCantidad, companionsRadioGroup);
                    }
                    
                    guestSearchResult.style.display = 'block';
                    companionsMessage.style.display = 'none';

                } catch (error) {
                    console.error('Error al buscar invitado:', error);
                    showCompanionsMessage('Error al buscar el invitado. Por favor intenta nuevamente.', 'error');
                } finally {
                    searchGuestBtn.disabled = false;
                    searchGuestBtn.textContent = 'Buscar';
                }
            });
        }

        // Guardar cambios de acompañantes
        if (saveCompanionsBtn) {
            saveCompanionsBtn.addEventListener('click', async function() {
                if (!currentGuestId) {
                    showCompanionsMessage('Por favor busca un invitado primero.', 'error');
                    return;
                }

                const selectedCount = document.querySelector('input[name="companionsCount"]:checked');
                if (!selectedCount) {
                    showCompanionsMessage('Por favor selecciona una cantidad de acompañantes.', 'error');
                    return;
                }

                const newCantidad = parseInt(selectedCount.value);

                // Validar que no se esté aumentando
                if (newCantidad > currentGuestCantidad) {
                    showCompanionsMessage('No se puede aumentar la cantidad de acompañantes. Solo se permite disminuir.', 'error');
                    return;
                }

                // Mostrar indicador de carga
                saveCompanionsBtn.disabled = true;
                saveCompanionsBtn.textContent = 'Guardando...';

                try {
                    // Intentar actualizar en Supabase si está disponible
                    if (useSupabase && supabaseService) {
                        try {
                            await supabaseService.updateCantidadAcompañantes(currentGuestId, newCantidad);
                            
                            // Actualizar en localStorage también
                            guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
                            const guestIndex = guestList.findIndex(g => g.id === currentGuestId);
                            if (guestIndex !== -1) {
                                guestList[guestIndex].cantidad_acompañante = newCantidad;
                                localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                            }
                        } catch (error) {
                            console.error('Error al actualizar en Supabase:', error);
                            // Intentar actualizar solo en localStorage como respaldo
                            guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
                            const guestIndex = guestList.findIndex(g => g.id === currentGuestId);
                            if (guestIndex !== -1) {
                                guestList[guestIndex].cantidad_acompañante = newCantidad;
                                localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                            }
                        }
                    } else {
                        // Actualizar solo en localStorage
                        guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
                        const guestIndex = guestList.findIndex(g => g.id === currentGuestId);
                        if (guestIndex !== -1) {
                            guestList[guestIndex].cantidad_acompañante = newCantidad;
                            localStorage.setItem('weddingGuests', JSON.stringify(guestList));
                        }
                    }

                    // Actualizar cantidad actual
                    currentGuestCantidad = newCantidad;
                    document.getElementById('currentCompanionsCount').textContent = newCantidad;
                    
                    // Actualizar etiqueta según la nueva cantidad
                    const companionsLabel = document.getElementById('companionsLabel');
                    if (newCantidad === 0) {
                        companionsLabel.textContent = 'acompañantes';
                    } else if (newCantidad === 1) {
                        companionsLabel.textContent = 'invitado';
                    } else {
                        companionsLabel.textContent = 'acompañantes';
                    }
                    
                    showCompanionsMessage(`✓ Cantidad de acompañantes actualizada exitosamente a ${newCantidad}.`, 'success');
                    
                    // Actualizar opciones visibles según la nueva cantidad
                    const companionsSelectionSection = document.getElementById('companionsSelectionSection');
                    const companionsRadioGroup = document.getElementById('companionsRadioGroup');
                    
                    // Si la nueva cantidad es 0, ocultar toda la sección de selección
                    if (newCantidad === 0) {
                        companionsSelectionSection.style.display = 'none';
                    } else {
                        // Regenerar opciones con la nueva cantidad
                        companionsSelectionSection.style.display = 'block';
                        generateCompanionsOptions(newCantidad, companionsRadioGroup);
                    }

                } catch (error) {
                    console.error('Error al guardar cambios:', error);
                    showCompanionsMessage('Error al guardar los cambios. Por favor intenta nuevamente.', 'error');
                } finally {
                    saveCompanionsBtn.disabled = false;
                    saveCompanionsBtn.textContent = 'Guardar Cambios';
                }
            });
        }

        // Función auxiliar para generar opciones de acompañantes dinámicamente
        function generateCompanionsOptions(currentCantidad, container) {
            // Limpiar opciones existentes
            container.innerHTML = '';
            
            // Generar opciones desde currentCantidad - 1 hasta 0 (solo disminución)
            for (let i = currentCantidad - 1; i >= 0; i--) {
                const label = document.createElement('label');
                label.className = 'radio-option';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = 'companionsCount';
                input.value = i;
                input.id = `companions${i}`;
                
                const span = document.createElement('span');
                if (i === 0) {
                    span.textContent = 'Sin acompañantes';
                } else if (i === 1) {
                    span.textContent = '1 invitado';
                } else {
                    span.textContent = `${i} acompañantes`;
                }
                
                label.appendChild(input);
                label.appendChild(span);
                container.appendChild(label);
            }
        }

        // Función auxiliar para mostrar mensajes
        function showCompanionsMessage(message, type) {
            companionsMessage.textContent = message;
            companionsMessage.className = 'companions-message ' + type;
            companionsMessage.style.display = 'block';
            
            // Ocultar después de 5 segundos si es éxito
            if (type === 'success') {
                setTimeout(() => {
                    companionsMessage.style.display = 'none';
                }, 5000);
            }
        }

        // Permitir búsqueda con Enter
        if (searchGuestNameInput) {
            searchGuestNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (searchGuestBtn) {
                        searchGuestBtn.click();
                    }
                }
            });
        }

        // ========== MODAL PARA CONSULTAR PASES ==========
        const checkPassesBtn = document.getElementById('checkPassesBtn');
        const passesModal = document.getElementById('passesModal');
        const passesModalClose = document.getElementById('passesModalClose');
        const searchPassesBtn = document.getElementById('searchPassesBtn');
        const searchPassesNameInput = document.getElementById('searchPassesName');
        const passesSearchResult = document.getElementById('passesSearchResult');
        const passesMessage = document.getElementById('passesMessage');

        // Función auxiliar para mostrar mensajes en el modal de pases
        function showPassesMessage(message, type) {
            passesMessage.textContent = message;
            passesMessage.className = 'companions-message ' + type;
            passesMessage.style.display = 'block';
            
            // Ocultar después de 5 segundos si es éxito
            if (type === 'success') {
                setTimeout(() => {
                    passesMessage.style.display = 'none';
                }, 5000);
            }
        }

        // Abrir modal
        if (checkPassesBtn) {
            checkPassesBtn.addEventListener('click', function() {
                passesModal.classList.add('show');
                document.body.style.overflow = 'hidden';
                // Limpiar formulario
                searchPassesNameInput.value = '';
                passesSearchResult.style.display = 'none';
                passesMessage.style.display = 'none';
            });
        }

        // Cerrar modal
        if (passesModalClose) {
            passesModalClose.addEventListener('click', function() {
                passesModal.classList.remove('show');
                document.body.style.overflow = '';
            });
        }

        // Cerrar modal al hacer clic fuera
        if (passesModal) {
            passesModal.addEventListener('click', function(e) {
                if (e.target === passesModal) {
                    passesModal.classList.remove('show');
                    document.body.style.overflow = '';
                }
            });
        }

        // Buscar invitado primero en confirmaciones, luego en invitados_maestro
        if (searchPassesBtn) {
            searchPassesBtn.addEventListener('click', async function() {
                const searchName = searchPassesNameInput.value.trim();
                
                if (!searchName || searchName.length < 2) {
                    showPassesMessage('Por favor ingresa un nombre válido (mínimo 2 caracteres)', 'error');
                    return;
                }

                // Mostrar indicador de carga
                searchPassesBtn.disabled = true;
                searchPassesBtn.textContent = 'Buscando...';

                try {
                    let guest = null;
                    let invitadoMaestro = null;

                    // Primero buscar en wedding_guests (tabla de confirmaciones)
                    if (useSupabase && supabaseService) {
                        try {
                            // Buscar en la tabla de confirmaciones
                            guest = await supabaseService.findGuestByName(searchName);
                            
                            if (!guest) {
                                showPassesMessage('No se encontró ningún invitado registrado con ese nombre. Por favor verifica que hayas confirmado tu asistencia.', 'error');
                                passesSearchResult.style.display = 'none';
                                searchPassesBtn.disabled = false;
                                searchPassesBtn.textContent = 'Buscar';
                                return;
                            }

                            // Si está registrado, buscar en invitados_maestro para obtener los pases
                            invitadoMaestro = await supabaseService.findInvitadoMaestro(guest.name);
                            
                        } catch (error) {
                            console.error('Error al buscar en Supabase:', error);
                            showPassesMessage('Error al buscar en la base de datos. Por favor intenta nuevamente.', 'error');
                            searchPassesBtn.disabled = false;
                            searchPassesBtn.textContent = 'Buscar';
                            return;
                        }
                    } else {
                        // Buscar en localStorage como respaldo
                        guestList = JSON.parse(localStorage.getItem('weddingGuests')) || [];
                        guest = guestList.find(g => g.name.toLowerCase().includes(searchName.toLowerCase()));
                        
                        if (!guest) {
                            showPassesMessage('No se encontró ningún invitado registrado con ese nombre. Por favor verifica que hayas confirmado tu asistencia.', 'error');
                            passesSearchResult.style.display = 'none';
                            searchPassesBtn.disabled = false;
                            searchPassesBtn.textContent = 'Buscar';
                            return;
                        }
                    }

                    // Si se encontró en confirmaciones pero no en invitados_maestro
                    if (!invitadoMaestro) {
                        // Mostrar información del invitado registrado pero sin pases en la lista maestra
                        document.getElementById('foundPassesGuestName').textContent = guest.name;
                        document.getElementById('currentPassesCount').textContent = guest.cantidad_acompañante || 0;
                        
                        const passesLabel = document.getElementById('passesLabel');
                        const cantidad = guest.cantidad_acompañante || 0;
                        if (cantidad === 1) {
                            passesLabel.textContent = 'pase';
                        } else {
                            passesLabel.textContent = 'pases';
                        }
                        
                        passesSearchResult.style.display = 'block';
                        passesMessage.style.display = 'none';
                        searchPassesBtn.disabled = false;
                        searchPassesBtn.textContent = 'Buscar';
                        return;
                    }

                    // Mostrar resultado con información de invitados_maestro
                    document.getElementById('foundPassesGuestName').textContent = invitadoMaestro.nombre;
                    document.getElementById('currentPassesCount').textContent = invitadoMaestro.cantidad_pases;
                    
                    // Actualizar etiqueta según la cantidad
                    const passesLabel = document.getElementById('passesLabel');
                    if (invitadoMaestro.cantidad_pases === 1) {
                        passesLabel.textContent = 'pase';
                    } else {
                        passesLabel.textContent = 'pases';
                    }
                    
                    passesSearchResult.style.display = 'block';
                    passesMessage.style.display = 'none';
                    searchPassesBtn.disabled = false;
                    searchPassesBtn.textContent = 'Buscar';

                } catch (error) {
                    console.error('Error al buscar pases:', error);
                    showPassesMessage('Hubo un error al buscar. Por favor intenta nuevamente.', 'error');
                    searchPassesBtn.disabled = false;
                    searchPassesBtn.textContent = 'Buscar';
                }
            });
        }

        // Permitir búsqueda con Enter en el modal de pases
        if (searchPassesNameInput) {
            searchPassesNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (searchPassesBtn) {
                        searchPassesBtn.click();
                    }
                }
            });
        }
    </script>
</body>
</html>
